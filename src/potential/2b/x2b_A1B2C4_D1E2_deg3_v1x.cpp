

#include "x2b_A1B2C4_D1E2_deg3_v1x.h"

////////////////////////////////////////////////////////////////////////////////

namespace {

struct variable {
    double v_exp(const double& k, const double* p1, const double* p2);

    void grads(const double& gg, double* grd1, double* grd2, const double* p1, const double* p2);

    double g[3];  // diff(value, p1 - p2)
};

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

double variable::v_exp(const double& k, const double* p1, const double* p2) {
    g[0] = p1[0] - p2[0];
    g[1] = p1[1] - p2[1];
    g[2] = p1[2] - p2[2];

    const double r = std::sqrt(g[0] * g[0] + g[1] * g[1] + g[2] * g[2]);

    const double exp1 = std::exp(k * (-r));
    const double gg = -k * exp1 / r;

    g[0] *= gg;
    g[1] *= gg;
    g[2] *= gg;

    return exp1;
}

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

void variable::grads(const double& gg, double* grd1, double* grd2, const double* p1, const double* p2) {
    for (size_t i = 0; i < 3; i++) {
        double d = gg * g[i];
        grd1[i] += d;
        grd2[i] -= d;
    }
}

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - //

}  // namespace

////////////////////////////////////////////////////////////////////////////////

namespace x2b_A1B2C4_D1E2_deg3 {

//----------------------------------------------------------------------------//

x2b_A1B2C4_D1E2_v1x::x2b_A1B2C4_D1E2_v1x(std::string mon1, std::string mon2) {
    // =====>> SECTION CONSTRUCTOR <<=====
    // =>> PASTE RIGHT BELOW THIS LINE <==
    if (mon1 == "h2o" && mon2 == "n2o5") {
        coefficients = std::vector<double>{9.455576307571745e+01,    // 0
                                           -2.093361479936092e+02,   // 1
                                           -6.287036153594985e+01,   // 2
                                           7.318953620561788e+01,    // 3
                                           -1.078251041695850e+02,   // 4
                                           2.014763416346277e+02,    // 5
                                           6.613829916374198e+01,    // 6
                                           3.406564986299479e+02,    // 7
                                           -1.668713067828687e+02,   // 8
                                           2.261403594965250e+01,    // 9
                                           3.749219378370171e+02,    // 10
                                           3.799018499545564e+01,    // 11
                                           -4.208349062283212e+02,   // 12
                                           -5.866810234530132e+01,   // 13
                                           -7.602254366382580e+01,   // 14
                                           -5.552493895281604e+01,   // 15
                                           -9.497050952510409e+01,   // 16
                                           -3.937424513004121e+01,   // 17
                                           -1.166793777811386e+02,   // 18
                                           -2.265241102279075e+02,   // 19
                                           -4.267884510521029e+00,   // 20
                                           9.389243636286101e+01,    // 21
                                           7.306934974058900e+01,    // 22
                                           1.703053884421738e+02,    // 23
                                           8.028445328365291e+01,    // 24
                                           1.908287395988350e+02,    // 25
                                           2.733284885826299e+01,    // 26
                                           4.058714353058095e+02,    // 27
                                           4.229992608701047e+00,    // 28
                                           1.594158120854695e+02,    // 29
                                           -4.346268012133054e+01,   // 30
                                           -9.400901723635417e+01,   // 31
                                           -6.220587465294252e+01,   // 32
                                           -1.733854951647991e+01,   // 33
                                           -1.076519981245380e+02,   // 34
                                           7.988287708924348e+01,    // 35
                                           -1.130656818131513e+02,   // 36
                                           1.307684471401219e+02,    // 37
                                           -1.317565515325826e+02,   // 38
                                           -9.802895221625378e+01,   // 39
                                           -1.521053618082104e+01,   // 40
                                           -1.705883783553597e+02,   // 41
                                           1.663973284035179e+01,    // 42
                                           5.589920638308541e+01,    // 43
                                           -5.507861970197549e+01,   // 44
                                           7.830358671082899e+01,    // 45
                                           9.177963541509548e+00,    // 46
                                           9.826678215776771e+01,    // 47
                                           2.416990374059775e+02,    // 48
                                           -1.027195440042357e+02,   // 49
                                           1.207139541090958e+02,    // 50
                                           -5.076194112720865e+01,   // 51
                                           2.921296603260430e+00,    // 52
                                           1.887533173998896e+00,    // 53
                                           1.383584479106817e+02,    // 54
                                           -8.755280748415498e+00,   // 55
                                           -9.585229858366152e+01,   // 56
                                           1.310332417776404e+02,    // 57
                                           -4.494301369929730e+01,   // 58
                                           -6.212843602956189e+00,   // 59
                                           5.358558438811335e+01,    // 60
                                           9.097108068431242e+00,    // 61
                                           9.513628363303883e+01,    // 62
                                           -1.576214459054173e+02,   // 63
                                           7.570255845098323e+01,    // 64
                                           -1.621315677092721e+02,   // 65
                                           -1.253607470680960e+02,   // 66
                                           1.184104868575174e+02,    // 67
                                           1.878525979698306e+02,    // 68
                                           6.023840088450279e+01,    // 69
                                           -6.237073260403178e+00,   // 70
                                           4.557713326698519e+01,    // 71
                                           -1.302469884275626e+02,   // 72
                                           6.582499339609227e+01,    // 73
                                           -6.488283669309646e+01,   // 74
                                           1.367168423766595e+02,    // 75
                                           -3.410871619340701e+01,   // 76
                                           3.562472486473933e+01,    // 77
                                           -3.219729476345799e+01,   // 78
                                           -1.299766505321490e+02,   // 79
                                           3.837189476728864e+02,    // 80
                                           1.091009895440910e+02,    // 81
                                           1.342248312908616e+02,    // 82
                                           -1.013597943811828e+02,   // 83
                                           -2.222709523366105e+02,   // 84
                                           1.003983507295093e+02,    // 85
                                           1.824374601109522e+01,    // 86
                                           -3.833720935762168e+01,   // 87
                                           4.225268902863738e+01,    // 88
                                           -2.043487748071329e+02,   // 89
                                           3.001232202052051e+00,    // 90
                                           2.316151490537862e+02,    // 91
                                           8.770217653187377e+01,    // 92
                                           -1.804325893335794e+01,   // 93
                                           -7.648339283001363e+01,   // 94
                                           -3.901916095291653e+02,   // 95
                                           2.955719339012843e+02,    // 96
                                           -8.285949777826855e+01,   // 97
                                           -1.289606117022094e+02,   // 98
                                           3.716442285645629e+01,    // 99
                                           -3.902329023702331e+02,   // 100
                                           -2.376699712876925e+02,   // 101
                                           -3.494632194218440e+02,   // 102
                                           -2.245566281345515e+02,   // 103
                                           3.021539422631686e+02,    // 104
                                           -4.444323810223860e+02,   // 105
                                           -3.357629298649894e+02,   // 106
                                           -4.110838813877081e+01,   // 107
                                           -5.959994627159679e+02,   // 108
                                           4.438512582592206e+02,    // 109
                                           5.515935161592978e+02,    // 110
                                           1.428795170568776e+01,    // 111
                                           2.396730028782032e+02,    // 112
                                           5.832580906767224e+02,    // 113
                                           -2.755121497800632e+02,   // 114
                                           7.485872453489559e+02,    // 115
                                           5.515811119092584e+02,    // 116
                                           5.256521236188654e+02,    // 117
                                           6.897392827087712e+02,    // 118
                                           -1.601735585278670e+02,   // 119
                                           -6.404158134963317e+02,   // 120
                                           5.236662137317063e+02,    // 121
                                           -3.060695126328786e+01,   // 122
                                           8.562655566880178e+00,    // 123
                                           -3.666291588180591e+02,   // 124
                                           2.929995183013340e+02,    // 125
                                           5.707707799404453e+02,    // 126
                                           -2.781901902242676e+02,   // 127
                                           8.976572893937467e+01,    // 128
                                           -1.321730252072015e+02,   // 129
                                           4.658730932102545e+01,    // 130
                                           6.855822187784596e+02,    // 131
                                           -7.636980004049872e+02,   // 132
                                           -1.552385556007019e+02,   // 133
                                           -3.546950557184915e+01,   // 134
                                           -7.492455410983302e-01,   // 135
                                           1.754896101901658e+01,    // 136
                                           -4.593790383327306e+02,   // 137
                                           -1.851319631810062e+02,   // 138
                                           8.507100649378518e+02,    // 139
                                           -1.871091433646084e+02,   // 140
                                           1.785828231200265e+02,    // 141
                                           2.051215458967344e+02,    // 142
                                           -1.198981860446065e+02,   // 143
                                           1.277659475899313e+02,    // 144
                                           5.343118278348418e+02,    // 145
                                           2.728678380056658e+02,    // 146
                                           -1.701603614683929e+02,   // 147
                                           -5.995228802770134e+01,   // 148
                                           -4.788986767355699e+02,   // 149
                                           -1.124006976070292e+01,   // 150
                                           -2.776693636862153e+02,   // 151
                                           -8.230763911856455e+01,   // 152
                                           9.117341381278574e+02,    // 153
                                           -3.050635268841642e+01,   // 154
                                           -2.382214598822811e+02,   // 155
                                           6.223155081985414e+01,    // 156
                                           -2.215402184558669e+02,   // 157
                                           -5.492676556456216e+01,   // 158
                                           -2.166467111761710e+02,   // 159
                                           2.792538259664263e+01,    // 160
                                           -9.804659900249703e+01,   // 161
                                           -1.266931183925974e+02,   // 162
                                           -1.956085204952581e+02,   // 163
                                           -4.099248384743434e+01,   // 164
                                           1.282917068568757e+01,    // 165
                                           5.061202202673132e+01,    // 166
                                           2.310475218373079e+02,    // 167
                                           2.521645277561580e+02,    // 168
                                           -8.071261798796970e+02,   // 169
                                           -1.335559389273260e+02,   // 170
                                           2.180662101409802e+01,    // 171
                                           1.683345995879135e+02,    // 172
                                           5.511788238618168e+01,    // 173
                                           -5.956850809509291e+02,   // 174
                                           -5.585984101066186e+02,   // 175
                                           9.044806921481756e+01,    // 176
                                           -3.088383967670010e+01,   // 177
                                           2.066342010886532e+02,    // 178
                                           -3.892065327772420e+02,   // 179
                                           6.833397178987970e+01,    // 180
                                           -1.295761882404923e+02,   // 181
                                           1.893856780891635e+02,    // 182
                                           -4.404579149997306e+02,   // 183
                                           1.392316588851150e+02,    // 184
                                           6.692321754067083e+02,    // 185
                                           2.514513684974190e+02,    // 186
                                           -4.844885722086999e+01,   // 187
                                           -4.598031551228264e+02,   // 188
                                           1.189049936802553e+02,    // 189
                                           4.113481727298308e+02,    // 190
                                           3.364046259029558e+02,    // 191
                                           -5.656421426895881e+02,   // 192
                                           -2.199057629376074e+02,   // 193
                                           -5.134233364589944e+01,   // 194
                                           -4.066388718417630e+02,   // 195
                                           -1.194805196581534e+02,   // 196
                                           -2.390220552784843e+02,   // 197
                                           7.968315735857631e+02,    // 198
                                           -1.672207911274731e+01,   // 199
                                           -2.380544737022047e+02,   // 200
                                           1.441253730848880e+02,    // 201
                                           7.119717344380905e+01,    // 202
                                           -1.320018820363988e+03,   // 203
                                           -1.897664240517343e+01,   // 204
                                           -2.509072274878849e+02,   // 205
                                           2.020888903316849e+02,    // 206
                                           -1.560719635110045e+02,   // 207
                                           3.966433187449020e+02,    // 208
                                           3.809909930916709e+02,    // 209
                                           -6.264358707033302e+02,   // 210
                                           -8.920280729702343e+01,   // 211
                                           1.841199426382326e+02,    // 212
                                           7.693302885834906e+02,    // 213
                                           -2.961562401649372e+02,   // 214
                                           2.379047062807860e+02,    // 215
                                           1.629112271700950e+02,    // 216
                                           3.082388088859645e+02,    // 217
                                           3.712579070694859e+02,    // 218
                                           -1.219750225981695e+02,   // 219
                                           1.767245756503239e+01,    // 220
                                           -5.431804200745737e+01,   // 221
                                           -1.399827598226761e+02,   // 222
                                           -5.410868963772665e+01,   // 223
                                           -3.233830901151560e+01,   // 224
                                           -1.913626955630432e+02,   // 225
                                           1.046637242782836e+02,    // 226
                                           5.086029757241188e+02,    // 227
                                           -1.419258017030360e+02,   // 228
                                           -4.760316970319396e-01,   // 229
                                           -4.450375193609794e+02,   // 230
                                           4.210225252689011e+02,    // 231
                                           -4.474294411876930e+02,   // 232
                                           3.241186929578145e+02,    // 233
                                           -6.926711767375490e+01,   // 234
                                           1.010351150265259e+02,    // 235
                                           -5.698397263124238e+01,   // 236
                                           3.205720234247607e+02,    // 237
                                           -5.099375160772551e+02,   // 238
                                           -1.750580027162223e+02,   // 239
                                           -7.364091841640018e+02,   // 240
                                           2.249924642494557e+02,    // 241
                                           2.192851054170915e+02,    // 242
                                           6.141957123816647e+02,    // 243
                                           -6.071619310568049e+02,   // 244
                                           7.505008386150049e+02,    // 245
                                           2.032586869654908e+02,    // 246
                                           3.738376432729876e+02,    // 247
                                           7.101990653547230e+01,    // 248
                                           -1.124693902936658e+02,   // 249
                                           7.654047590264970e+02,    // 250
                                           -1.664765117866975e+02,   // 251
                                           -1.336522993112516e+02,   // 252
                                           2.968395282428569e+02,    // 253
                                           -4.995092655581696e+01,   // 254
                                           1.489213267776695e+02,    // 255
                                           -1.086565963279615e+01,   // 256
                                           -1.101582298131871e+01,   // 257
                                           -6.242496728567811e+01,   // 258
                                           4.443829365882790e+01,    // 259
                                           -3.672321710251488e+02,   // 260
                                           1.295879925697890e+01,    // 261
                                           1.151589835792502e+02,    // 262
                                           3.947040345398643e+02,    // 263
                                           -2.129558277643571e+02,   // 264
                                           -2.533541176757218e+01,   // 265
                                           -5.905008216423078e+01,   // 266
                                           -5.324165832843307e+01,   // 267
                                           -3.876064867840619e+02,   // 268
                                           9.427275945088876e+01,    // 269
                                           8.160222831433515e+01,    // 270
                                           -1.643753016391885e+02,   // 271
                                           -4.204689931784183e+02,   // 272
                                           -2.245549199309345e+02,   // 273
                                           6.683287658916019e+01,    // 274
                                           -7.588240423044564e+01,   // 275
                                           -8.408827549751582e+01,   // 276
                                           -5.119462372928803e+01,   // 277
                                           7.398696912548266e+01,    // 278
                                           -1.292468194248739e+02,   // 279
                                           2.642800131777812e+01,    // 280
                                           7.923341439058461e+01,    // 281
                                           1.269172537051523e+02,    // 282
                                           1.015185907048727e+02,    // 283
                                           -1.585862047611001e+02,   // 284
                                           -4.780042904365945e+02,   // 285
                                           2.290513546454434e+02,    // 286
                                           -4.976571207964593e+02,   // 287
                                           1.047053285172762e+02,    // 288
                                           9.478392852493039e+01,    // 289
                                           -2.455830955655989e+01,   // 290
                                           7.225195722904112e+01,    // 291
                                           8.581506183959281e+00,    // 292
                                           3.709530313160899e+02,    // 293
                                           -3.863131563217724e+01,   // 294
                                           1.842041164293716e+02,    // 295
                                           3.004612136305798e+02,    // 296
                                           1.468458817550612e+02,    // 297
                                           5.428592390780063e+01,    // 298
                                           -8.740253988218410e+01,   // 299
                                           3.045174168561577e+01,    // 300
                                           -3.427386334388180e+00,   // 301
                                           -2.678007089653995e+02,   // 302
                                           -1.784808364618351e+02,   // 303
                                           1.765326831811135e+02,    // 304
                                           -5.289397653295258e+01,   // 305
                                           1.070921411593200e+02,    // 306
                                           4.704179490786666e+01,    // 307
                                           -2.579907373331039e+02,   // 308
                                           1.035127238629201e+01,    // 309
                                           -6.728273621714019e+02,   // 310
                                           2.447621086010240e+02,    // 311
                                           -6.031290229006656e+02,   // 312
                                           -1.306271036062872e+02,   // 313
                                           -7.614448995346079e+01,   // 314
                                           6.056405033798982e+01,    // 315
                                           4.330899450613328e+02,    // 316
                                           1.373787467051040e+02,    // 317
                                           -1.466803098936351e+02,   // 318
                                           5.049623342621852e+01,    // 319
                                           3.099013641998923e+01,    // 320
                                           -6.608105745587386e+01,   // 321
                                           -8.261782563745273e+01,   // 322
                                           1.498258546696620e+02,    // 323
                                           -1.361903728085127e+02,   // 324
                                           7.879038916110878e+01,    // 325
                                           1.553706036683147e+01,    // 326
                                           -5.040974960786889e+01,   // 327
                                           -1.632360098755056e+01,   // 328
                                           -1.465268972901648e+01,   // 329
                                           1.862789530354041e+01,    // 330
                                           -1.005399237756489e+02,   // 331
                                           1.153396616475000e+02,    // 332
                                           5.721058503083315e+01,    // 333
                                           1.035393737038828e+02,    // 334
                                           1.793755396848900e+02,    // 335
                                           1.293491050808838e+02,    // 336
                                           -1.348705825446823e+02,   // 337
                                           -3.083637019848161e+02,   // 338
                                           5.245680694968090e+00,    // 339
                                           -1.891852256943106e+02,   // 340
                                           -6.048780856026369e+01,   // 341
                                           2.189579569982112e+02,    // 342
                                           -7.432913325160373e+00,   // 343
                                           1.452030762726888e+02,    // 344
                                           7.243301750124762e+01,    // 345
                                           -1.498015983418208e+02,   // 346
                                           2.139680662256850e+02,    // 347
                                           -2.377056885310471e+02,   // 348
                                           1.915759171599630e+02,    // 349
                                           -3.928986372892761e+01,   // 350
                                           1.551814529799079e+01,    // 351
                                           -2.131061842078644e+01,   // 352
                                           -1.767540688278647e+02,   // 353
                                           2.762115394002515e+02,    // 354
                                           7.981913813223696e+01,    // 355
                                           2.934090922610247e+01,    // 356
                                           1.117328956897870e+02,    // 357
                                           -5.416723352478698e+01,   // 358
                                           -1.646671447992607e+02,   // 359
                                           -4.363106939009651e+02,   // 360
                                           -5.519364342635824e+01,   // 361
                                           -5.848235553286172e+00,   // 362
                                           9.432680766187589e+01,    // 363
                                           1.254239943650504e+02,    // 364
                                           -1.262357120727188e+02,   // 365
                                           -2.269767440654871e+02,   // 366
                                           1.559596874694824e+02,    // 367
                                           -6.797520991055310e+01,   // 368
                                           -7.126670358180252e+01,   // 369
                                           1.607897449965544e+02,    // 370
                                           -9.697200091269873e+01,   // 371
                                           -6.435005433604627e+01,   // 372
                                           1.679977187467466e+02,    // 373
                                           1.539803672932389e+02,    // 374
                                           8.208816537854527e+01,    // 375
                                           -1.685192836154162e+02,   // 376
                                           3.018317756146686e+02,    // 377
                                           1.827782128968217e+02,    // 378
                                           -2.099475568709510e+02,   // 379
                                           -9.140878458745048e+01,   // 380
                                           3.649260385070018e+00,    // 381
                                           2.571707481397889e+02,    // 382
                                           6.148229616958125e+01,    // 383
                                           -1.889172411792634e+02,   // 384
                                           1.235634244609743e+02,    // 385
                                           -3.077745589019117e+02,   // 386
                                           -3.063184334613849e+02,   // 387
                                           3.057122961396219e+02,    // 388
                                           2.334515166438625e+02,    // 389
                                           3.768785619963494e+02,    // 390
                                           1.685107209850923e+02,    // 391
                                           -1.997010454235624e+02,   // 392
                                           -3.350155608728187e+02,   // 393
                                           -5.399342529682323e+02,   // 394
                                           1.938474355731298e+02,    // 395
                                           4.451908671482418e+02,    // 396
                                           4.271836738172606e+02,    // 397
                                           -2.599486394850794e+01,   // 398
                                           3.286661050617172e+02,    // 399
                                           -3.332939911211485e+02,   // 400
                                           -2.025300738556601e+02,   // 401
                                           1.204953575086391e+02,    // 402
                                           3.649870538945979e+02,    // 403
                                           -9.948596420024167e+01,   // 404
                                           -4.716300534097720e+02,   // 405
                                           -6.706785256415965e+01,   // 406
                                           2.977860260648570e+02,    // 407
                                           3.358032277328713e+02,    // 408
                                           1.850560811266792e+01,    // 409
                                           4.354496765611803e+01,    // 410
                                           3.695042978951014e+02,    // 411
                                           -7.690760747624384e+00,   // 412
                                           -5.395091601846413e+01,   // 413
                                           8.540856811187023e+00,    // 414
                                           1.622567985574299e+02,    // 415
                                           -9.720068009188383e+00,   // 416
                                           -1.972201592723734e+02,   // 417
                                           2.871818899651844e+01,    // 418
                                           -2.586968084118962e+02,   // 419
                                           3.502744091171596e+01,    // 420
                                           -4.821053194408609e+02,   // 421
                                           5.682708279854769e+01,    // 422
                                           -1.951511740546767e+02,   // 423
                                           1.697145206033438e+02,    // 424
                                           -1.483577243652217e+02,   // 425
                                           -5.102083978771510e+01,   // 426
                                           4.993656790424753e+01,    // 427
                                           -1.470961631203886e+02,   // 428
                                           5.231997197882318e+01,    // 429
                                           -2.367776422834318e+02,   // 430
                                           -3.296740288732348e+02,   // 431
                                           1.586820750605319e+02,    // 432
                                           1.563340252566456e+01,    // 433
                                           -2.081115604091297e+02,   // 434
                                           2.616629254601871e+02,    // 435
                                           4.573903369766455e+01,    // 436
                                           2.771077792786850e+02,    // 437
                                           -1.059934340931695e+01,   // 438
                                           -5.868595891519366e+02,   // 439
                                           3.512575257596006e+02,    // 440
                                           -3.642556463144078e+02,   // 441
                                           -7.764237191108367e+01,   // 442
                                           -2.213252984073152e+02,   // 443
                                           9.980951222106897e+01,    // 444
                                           1.913465340907339e+02,    // 445
                                           1.776839210594432e+02,    // 446
                                           7.412669439067494e+01,    // 447
                                           -9.363176105179100e+01,   // 448
                                           -2.153831026327072e+02,   // 449
                                           1.157221645276391e+02,    // 450
                                           2.486842022031892e+01,    // 451
                                           -1.815670952193459e+02,   // 452
                                           -1.884656738817348e+02,   // 453
                                           7.261909957710948e+01,    // 454
                                           2.139399928756313e+02,    // 455
                                           -1.282174608906267e+02,   // 456
                                           -1.763951404126081e+01,   // 457
                                           -7.080660638577739e+01,   // 458
                                           2.079271682367364e+01,    // 459
                                           5.593304625349440e+01,    // 460
                                           -2.289194954965127e+00,   // 461
                                           4.651563173185068e+01,    // 462
                                           3.069383696346954e+01,    // 463
                                           -6.818680290549683e+01,   // 464
                                           2.398676290957293e+02,    // 465
                                           -2.981604591833913e+02,   // 466
                                           -1.780600460937506e+02,   // 467
                                           2.483889775305839e+02,    // 468
                                           1.544802656243814e+02,    // 469
                                           3.643686071843694e+02,    // 470
                                           -4.915307663000037e+02,   // 471
                                           7.150700501130328e+01,    // 472
                                           8.975763853242950e+01,    // 473
                                           5.607192883466359e+01,    // 474
                                           1.325718592500524e+02,    // 475
                                           1.632087741162708e+01,    // 476
                                           1.626509330157647e+02,    // 477
                                           -2.119452427378198e+01,   // 478
                                           -2.038299367056192e+02,   // 479
                                           2.019764259807967e+02,    // 480
                                           2.598046181676551e+02,    // 481
                                           -1.854200981450433e+02,   // 482
                                           -1.453370794111451e+02,   // 483
                                           -2.326544490759727e+01,   // 484
                                           -7.884926082679257e+01,   // 485
                                           2.786079445658127e+02,    // 486
                                           6.069539226059586e+02,    // 487
                                           -4.594069104606698e+02,   // 488
                                           -7.375163113500751e+01,   // 489
                                           1.005439086254496e+02,    // 490
                                           -1.276150872456792e+01,   // 491
                                           -4.540510694858563e+01,   // 492
                                           -5.325430408742128e+01,   // 493
                                           7.823557104968016e+01,    // 494
                                           -9.601721444210993e+01,   // 495
                                           1.691395282434741e+02,    // 496
                                           1.327198339240641e+02,    // 497
                                           -4.570844894317890e+01,   // 498
                                           -6.689854050444022e+01,   // 499
                                           -5.951607983404936e+01,   // 500
                                           2.408136917480043e+02,    // 501
                                           -5.608502532047454e+02,   // 502
                                           -5.069089727604826e+02,   // 503
                                           6.809923530568961e+02,    // 504
                                           1.523985014305906e+02,    // 505
                                           -5.369824660535986e+01,   // 506
                                           1.132241115893362e+02,    // 507
                                           9.295797988705381e+01,    // 508
                                           -6.856484616818055e+01,   // 509
                                           1.919261130767411e+01,    // 510
                                           6.305440166353512e+01,    // 511
                                           -7.657467030910408e+00,   // 512
                                           5.003698382190380e+01,    // 513
                                           1.327395591663245e+02,    // 514
                                           -1.467778906728622e+01,   // 515
                                           1.254513948830144e+01,    // 516
                                           1.702839410916172e+02,    // 517
                                           1.353054642133545e+02,    // 518
                                           4.558628653781037e+02,    // 519
                                           9.337839905816544e+01,    // 520
                                           -6.452020817252011e+01,   // 521
                                           2.972180867460665e+01,    // 522
                                           -5.022413049140918e+02,   // 523
                                           -5.037678968429660e+02,   // 524
                                           -1.861746952078033e+02,   // 525
                                           4.002673454342658e+02,    // 526
                                           -5.794495066616506e+01,   // 527
                                           -4.999717784305715e+01,   // 528
                                           -3.382820294055050e+02,   // 529
                                           -1.887421107117850e+01,   // 530
                                           -4.055362419812071e+02,   // 531
                                           2.534960968820716e+02,    // 532
                                           5.081712954167677e+02,    // 533
                                           6.458520252440981e+02,    // 534
                                           3.233887468615043e+02,    // 535
                                           -4.697069400173431e+01,   // 536
                                           2.346273222105395e+01,    // 537
                                           -2.409428966486906e+02,   // 538
                                           3.972220805936960e+01,    // 539
                                           2.009685046129442e+02,    // 540
                                           1.527091436795746e+02,    // 541
                                           -2.340531188079632e+02,   // 542
                                           8.652605665954451e+01,    // 543
                                           3.929218406116843e+02,    // 544
                                           1.265717649892267e+02,    // 545
                                           -2.823003342144573e+00,   // 546
                                           1.903309478968334e+02,    // 547
                                           4.518322967695480e+01,    // 548
                                           -9.976353011786605e+01,   // 549
                                           -4.567281894578391e+02,   // 550
                                           -6.834556028204952e+00,   // 551
                                           -6.682294284093275e+01,   // 552
                                           -4.827313949316563e+02,   // 553
                                           -4.921927663384181e+00,   // 554
                                           -1.820761077094687e+02,   // 555
                                           -6.775708407201456e+01,   // 556
                                           -3.581120315593368e+01,   // 557
                                           7.089766705861476e+02,    // 558
                                           3.031454951921262e+02,    // 559
                                           -8.875359315344696e+01,   // 560
                                           3.220012210454798e+01,    // 561
                                           -2.590947054312894e+01,   // 562
                                           -1.241988390018653e+02,   // 563
                                           -1.967343535319742e+02,   // 564
                                           4.056268587534619e+02,    // 565
                                           -1.303676523048840e+02,   // 566
                                           1.612968140110126e+02,    // 567
                                           2.895365573333605e+02,    // 568
                                           -4.328506598349188e+02,   // 569
                                           1.401561729467103e+02,    // 570
                                           -2.194745409394746e+02,   // 571
                                           -2.129568895850777e+01,   // 572
                                           6.368205470907844e+01,    // 573
                                           4.977327066507966e+01,    // 574
                                           1.201658152478284e+01,    // 575
                                           -3.479910212015708e+02,   // 576
                                           -1.083080446287114e+02,   // 577
                                           1.038813470880248e+01,    // 578
                                           1.075489765895817e+02,    // 579
                                           -4.962175398972140e+01,   // 580
                                           3.442747874194138e+01,    // 581
                                           -2.584680031659095e+01,   // 582
                                           -2.084035587249054e+02,   // 583
                                           -1.798418050527290e+02,   // 584
                                           -4.937222658207489e+01,   // 585
                                           -1.001929469798914e+02,   // 586
                                           9.014157316051559e+01,    // 587
                                           1.529319529456833e+02,    // 588
                                           -1.068010961898208e+02,   // 589
                                           9.564682300427651e+01,    // 590
                                           -1.566895574975714e+02,   // 591
                                           -3.513297754941640e+01,   // 592
                                           6.191594806657358e+01,    // 593
                                           -1.677496209169571e+02,   // 594
                                           2.296876933006286e+02,    // 595
                                           -7.651331035889245e+01,   // 596
                                           1.187020269719581e+02,    // 597
                                           5.671853306549849e+01,    // 598
                                           -4.146150977448963e+01,   // 599
                                           -7.205161841160178e+01,   // 600
                                           -1.543540591428890e+02,   // 601
                                           2.220026521583355e+02,    // 602
                                           1.222399038427814e+02,    // 603
                                           1.817878918869812e+02,    // 604
                                           -9.892482478412681e+01,   // 605
                                           -1.485331187783730e+02,   // 606
                                           -2.624461662097220e+01,   // 607
                                           4.056990921204738e+01,    // 608
                                           -1.034073855989070e+02,   // 609
                                           2.018037240713572e+02,    // 610
                                           1.879342270466970e+02,    // 611
                                           -2.367402792869017e+02,   // 612
                                           2.333622125281570e+02,    // 613
                                           -2.943869467191122e+01,   // 614
                                           1.944390759840541e+02,    // 615
                                           -3.993806731722020e+01,   // 616
                                           -1.354914618921345e+02,   // 617
                                           -2.347965351156889e+01,   // 618
                                           1.187122664896118e+02,    // 619
                                           -9.421479177947752e+01,   // 620
                                           1.347008750431927e+01,    // 621
                                           7.767259203067714e+01,    // 622
                                           9.120722624216759e+01,    // 623
                                           -1.935753193213144e+02,   // 624
                                           -7.453274560167453e+01,   // 625
                                           2.703485664079823e+02,    // 626
                                           2.617984884751695e+02,    // 627
                                           -2.822726334534483e+02,   // 628
                                           -2.384072727732798e+02,   // 629
                                           3.436693945231947e+02,    // 630
                                           -2.936677723529097e+02,   // 631
                                           -9.335016641988302e+01,   // 632
                                           9.442071062914946e+00,    // 633
                                           2.814790141566973e+02,    // 634
                                           6.539479174849596e+01,    // 635
                                           1.401081113614878e+02,    // 636
                                           2.470424810838423e+01,    // 637
                                           6.862400423173003e+01,    // 638
                                           2.740446397996645e+01,    // 639
                                           -1.306355978987993e+02,   // 640
                                           2.479014647648603e+02,    // 641
                                           -4.019497491873538e+02,   // 642
                                           -1.809186045031536e+01,   // 643
                                           5.372683227374422e+02,    // 644
                                           1.540707074305533e+02,    // 645
                                           -2.577398180693575e+02,   // 646
                                           8.244594167028843e+01,    // 647
                                           -1.691218580302191e+02,   // 648
                                           1.052698120288911e+02,    // 649
                                           -4.701866029425943e+01,   // 650
                                           5.438636737424948e+02,    // 651
                                           -4.113279402543428e+01,   // 652
                                           5.580721313072980e+02,    // 653
                                           -2.873153461361238e+02,   // 654
                                           -1.250964193737839e+02,   // 655
                                           -4.467474930576623e+02,   // 656
                                           4.121364320516316e+01,    // 657
                                           -2.636755206958307e+02,   // 658
                                           8.157618091290944e+01,    // 659
                                           -7.607081143441130e+01,   // 660
                                           3.862777432757372e+01,    // 661
                                           4.535645841378665e+02,    // 662
                                           -6.294786440939412e+01,   // 663
                                           2.905652767540512e+01,    // 664
                                           1.447533856992393e+02,    // 665
                                           8.122229222596243e+00,    // 666
                                           1.119093216601708e+03,    // 667
                                           6.021765761251741e+01,    // 668
                                           -9.922313426447247e+02,   // 669
                                           -5.411712136888364e+02,   // 670
                                           4.806807450076743e+02,    // 671
                                           1.841202980372047e+02,    // 672
                                           1.158847920359751e+02,    // 673
                                           -2.609915719351133e+02,   // 674
                                           -1.501654398420847e+02,   // 675
                                           -3.334244398114951e+02,   // 676
                                           -1.935668721063565e+01,   // 677
                                           -3.517368478062642e+02,   // 678
                                           6.695804431789065e+01,    // 679
                                           1.439928452625000e+02,    // 680
                                           -5.286249078653854e+01,   // 681
                                           9.725076610854020e+01,    // 682
                                           -7.161990441779375e+01,   // 683
                                           -1.499459382657244e+02,   // 684
                                           2.124726262695368e+02,    // 685
                                           -2.568190993569806e+01,   // 686
                                           -4.384435614421574e+01,   // 687
                                           -3.458482042261269e+01,   // 688
                                           1.234740291378861e+01,    // 689
                                           1.015163424629140e+01,    // 690
                                           1.051999504917971e+02,    // 691
                                           1.174223956352567e+02,    // 692
                                           -9.907965107404384e+01,   // 693
                                           1.793078363271069e+02,    // 694
                                           5.670076793048156e+01,    // 695
                                           -2.661057273697421e+01,   // 696
                                           -1.354448765314382e+02,   // 697
                                           1.581421732798434e+02,    // 698
                                           1.788383269313883e+02,    // 699
                                           9.873575206662225e+01,    // 700
                                           -2.624191744488929e+02,   // 701
                                           4.129997403532402e+02,    // 702
                                           3.263356125284131e+02,    // 703
                                           -6.871073559560492e+02,   // 704
                                           2.437466533101825e+01,    // 705
                                           8.435307047431230e+01,    // 706
                                           -1.138615536998958e+02,   // 707
                                           -1.590668873951253e+02,   // 708
                                           -1.613517318147019e+01,   // 709
                                           1.049337049535385e+02,    // 710
                                           1.653896436122165e+02,    // 711
                                           -4.869620166249476e+02,   // 712
                                           -6.018942614317353e+02,   // 713
                                           9.628044631493145e+02,    // 714
                                           -2.149254829829052e+00,   // 715
                                           -1.130942420040164e+02,   // 716
                                           1.189091631931201e+01,    // 717
                                           2.408940001438095e+02,    // 718
                                           1.734359529402022e+02,    // 719
                                           -1.322635017439875e+02,   // 720
                                           3.295463308108398e+01,    // 721
                                           -1.995298413927508e+02,   // 722
                                           -7.079180489249082e+01,   // 723
                                           -1.277651008009114e+02,   // 724
                                           -6.891117921181591e+01,   // 725
                                           -5.991652469304371e+01,   // 726
                                           -4.274637826096666e+01,   // 727
                                           1.117784241678301e+01,    // 728
                                           -1.926300806849424e+02,   // 729
                                           -4.799793429781103e+01,   // 730
                                           1.028155332256193e+02,    // 731
                                           6.784173139030889e+00,    // 732
                                           1.298325462912875e+02,    // 733
                                           1.526092203102087e+01,    // 734
                                           2.075739496769488e+02,    // 735
                                           -2.119875146070603e+02,   // 736
                                           -2.124072343859662e+01,   // 737
                                           -5.488061585269746e+01,   // 738
                                           1.120924698706561e+02,    // 739
                                           1.410284688779806e+02,    // 740
                                           8.380553068288833e+00,    // 741
                                           1.452317235325180e+00,    // 742
                                           1.882566437210658e+02,    // 743
                                           -2.529769012372023e+02,   // 744
                                           -5.291384118504573e+01,   // 745
                                           1.709806903469913e+02,    // 746
                                           -1.352002814461485e+02,   // 747
                                           -2.980980895916898e+02,   // 748
                                           4.282628306412846e+01,    // 749
                                           1.073011318602452e+01,    // 750
                                           -8.473225394050669e+01,   // 751
                                           -1.511911742717806e+02,   // 752
                                           8.116876597599337e+02,    // 753
                                           -1.969647612163870e+02,   // 754
                                           -9.524509229127894e+01,   // 755
                                           -1.963715014044613e+01,   // 756
                                           3.278947495628474e+02,    // 757
                                           -2.205824008318350e+02,   // 758
                                           -4.356065959408766e+02,   // 759
                                           3.755842909670024e+01,    // 760
                                           -9.261486699255105e+00,   // 761
                                           -3.511081373260657e+02,   // 762
                                           -8.928769367325133e+00,   // 763
                                           3.222903319757635e+02,    // 764
                                           -3.447204146974844e+02,   // 765
                                           -2.664933329980141e+02,   // 766
                                           4.901867441162275e+01,    // 767
                                           3.411166518038670e+02,    // 768
                                           6.169974267549246e+01,    // 769
                                           -8.829723410093527e+01,   // 770
                                           -1.738248293740498e+02,   // 771
                                           1.050834437927053e+02,    // 772
                                           -2.140367405704306e+01,   // 773
                                           1.679526062153189e+02,    // 774
                                           -5.883847978164624e+01,   // 775
                                           1.542530413597898e+02,    // 776
                                           -1.915363765451178e+02,   // 777
                                           1.082828078956512e+02,    // 778
                                           3.195599522896495e+01,    // 779
                                           -1.737216034728003e+02,   // 780
                                           -1.133504559540070e+02,   // 781
                                           1.341863282033332e+02,    // 782
                                           1.549784281676060e+02,    // 783
                                           5.420644979203306e+01,    // 784
                                           -1.250621337910098e+02,   // 785
                                           -2.177301161208132e+02,   // 786
                                           4.654105410616440e+01,    // 787
                                           7.942764583985205e+01,    // 788
                                           -3.925123587830212e+01,   // 789
                                           -2.817126242676634e+02,   // 790
                                           4.818043385408790e+01,    // 791
                                           -2.000634871737282e+02,   // 792
                                           2.703195051623497e+02,    // 793
                                           1.699547745286944e+02,    // 794
                                           -2.839594375829550e+02,   // 795
                                           6.809580700707619e+01,    // 796
                                           1.340857494576355e+01,    // 797
                                           4.067118593461823e+02,    // 798
                                           -9.330361660165765e+01,   // 799
                                           5.445487901220024e+01,    // 800
                                           1.382791228737590e+02,    // 801
                                           -1.977496088990845e+02,   // 802
                                           -1.284219495917526e+02,   // 803
                                           -5.627109663373903e+01,   // 804
                                           -2.198920076761244e+01,   // 805
                                           2.284941266645911e+01,    // 806
                                           1.961637212677814e+02,    // 807
                                           -8.178272922598238e+00,   // 808
                                           -5.551459553701748e+01,   // 809
                                           4.653214364399093e+01,    // 810
                                           3.146114721882183e+01,    // 811
                                           7.775862548692182e+00,    // 812
                                           -4.402331457329222e+01,   // 813
                                           -3.669385237169949e+01,   // 814
                                           -1.074278095349168e+02,   // 815
                                           -1.224418617506118e+01,   // 816
                                           -5.232746720919135e+01,   // 817
                                           -1.784996028521452e+02,   // 818
                                           7.136183675040685e+01,    // 819
                                           -7.819504820227141e+01,   // 820
                                           5.782002137421004e+01,    // 821
                                           5.475603758266582e+01,    // 822
                                           1.351212765499843e+02,    // 823
                                           -1.164351905183943e+02,   // 824
                                           2.733162560109013e+00,    // 825
                                           -4.080748417975488e+02,   // 826
                                           1.429530328393121e+02,    // 827
                                           -9.548241322062660e+01,   // 828
                                           -5.587832528316237e+00,   // 829
                                           4.945226818880153e+01,    // 830
                                           -1.697062327117586e+01,   // 831
                                           -1.372045197593916e+02,   // 832
                                           -1.956160566895607e+02,   // 833
                                           3.036036987637372e+02,    // 834
                                           2.064341660305227e+01,    // 835
                                           -2.224486499111179e+02,   // 836
                                           7.854253295453812e+01,    // 837
                                           -7.078354208362519e+01,   // 838
                                           5.408548131743054e+02,    // 839
                                           -3.314540137704474e+02,   // 840
                                           1.323936001686776e+02,    // 841
                                           -1.543426250842875e+02,   // 842
                                           -2.699389796938854e+02,   // 843
                                           1.957979446354816e+02,    // 844
                                           5.445532839162443e+01,    // 845
                                           -2.807052763689954e+02,   // 846
                                           2.984324292381256e+01,    // 847
                                           2.002177534554297e+01,    // 848
                                           -1.917107815029438e+02,   // 849
                                           -1.677790511423739e+02,   // 850
                                           -3.404395725252429e+02,   // 851
                                           2.547793712238271e+02,    // 852
                                           7.733854202663922e+01,    // 853
                                           -8.294781729516720e+01,   // 854
                                           1.313022721506420e+02,    // 855
                                           -3.427480043657205e+02,   // 856
                                           -8.961484024363045e+01,   // 857
                                           3.494223798248650e+02,    // 858
                                           -9.178366625145041e+01,   // 859
                                           1.996727098020132e+02,    // 860
                                           -6.370904856866863e+02,   // 861
                                           2.745766612662828e+02,    // 862
                                           -1.846842084381646e+01,   // 863
                                           -1.353651261825791e+01,   // 864
                                           -2.873923385638673e+02,   // 865
                                           3.590845035523418e+02,    // 866
                                           7.689701793982013e+01,    // 867
                                           9.888519283479192e+01,    // 868
                                           1.174959973768417e+02,    // 869
                                           -5.633698586695584e+01,   // 870
                                           6.714232817974973e+01,    // 871
                                           -7.498088919404540e+01,   // 872
                                           -1.908535659985774e+01,   // 873
                                           1.317412380692770e+02,    // 874
                                           -1.655238296319076e+02,   // 875
                                           -4.635300648724317e+01,   // 876
                                           4.549196375194231e+01,    // 877
                                           -9.280188060675492e+01,   // 878
                                           2.932083270194465e+00,    // 879
                                           6.240109354896866e+01,    // 880
                                           4.491527460455796e+01,    // 881
                                           2.132005404455460e+02,    // 882
                                           -2.198482725179106e+02,   // 883
                                           2.155117011480851e+02,    // 884
                                           8.380626487029654e+01,    // 885
                                           5.726514593187943e+02,    // 886
                                           -2.845620817739591e+02,   // 887
                                           1.168878234458871e+02,    // 888
                                           -6.187028884740505e+01,   // 889
                                           1.008295647157562e+02,    // 890
                                           2.602419003070608e+01,    // 891
                                           1.840627048844624e+02,    // 892
                                           2.874907468662679e+01,    // 893
                                           5.493395714514866e+01,    // 894
                                           5.294569434504816e+01,    // 895
                                           1.493883642913220e+02,    // 896
                                           1.750160257212897e+02,    // 897
                                           2.531300105415291e+02,    // 898
                                           9.775319640133864e+01,    // 899
                                           1.379560135817124e+02,    // 900
                                           -1.852872108405801e+02,   // 901
                                           -6.837194788037927e+01,   // 902
                                           -4.354824520774640e+02,   // 903
                                           6.047371185383839e+01,    // 904
                                           2.954903005309606e+01,    // 905
                                           1.348409523680426e+02,    // 906
                                           2.169021557431636e+02,    // 907
                                           1.734425007349400e+02,    // 908
                                           -1.150266282324734e+02,   // 909
                                           -1.700983603626968e+02,   // 910
                                           -1.570305147086814e+02,   // 911
                                           -1.068877740137390e+02,   // 912
                                           -1.518114139193375e+02,   // 913
                                           4.655355188993490e+01,    // 914
                                           3.541488664638439e+01,    // 915
                                           2.646617882681521e+02,    // 916
                                           5.242943665321209e+01,    // 917
                                           -2.075684313942834e+02,   // 918
                                           3.175735595301822e+02,    // 919
                                           -1.611877198895695e+02,   // 920
                                           6.708304064249906e+01,    // 921
                                           2.701032347258934e+02,    // 922
                                           1.214786605926222e+02,    // 923
                                           -2.945782120699187e+02,   // 924
                                           7.837039013738922e+01,    // 925
                                           1.127781285727806e+02,    // 926
                                           -9.926770442300449e+01,   // 927
                                           -2.152297874034398e+02,   // 928
                                           1.164847693263367e+02,    // 929
                                           3.805339333008080e+01,    // 930
                                           -3.031898701211662e+02,   // 931
                                           -1.659250839322877e+01,   // 932
                                           -2.998653219964374e+02,   // 933
                                           2.849143331786688e+02,    // 934
                                           -5.875973271515694e+01,   // 935
                                           -3.553779041023243e+00,   // 936
                                           9.269873358758441e+01,    // 937
                                           -1.042673680393166e+02,   // 938
                                           -8.939353678749097e+01,   // 939
                                           1.882459184525403e+01,    // 940
                                           -2.276076810948126e+01,   // 941
                                           9.206942125101000e+00,    // 942
                                           -1.372020316573041e+02,   // 943
                                           8.772191240228307e+01,    // 944
                                           3.372177549414185e+01,    // 945
                                           -1.506569672808869e+01,   // 946
                                           1.127762057467743e+01,    // 947
                                           -1.309838804720419e+02,   // 948
                                           2.435776673321192e+02,    // 949
                                           -3.369377008063413e+01,   // 950
                                           -1.717669367659378e+02,   // 951
                                           8.458477770429995e+01,    // 952
                                           6.682160256521871e+01,    // 953
                                           1.222547467682911e+02,    // 954
                                           -2.605358584627729e+02,   // 955
                                           1.307556545124552e+02,    // 956
                                           3.697506739796296e+01,    // 957
                                           -9.750784656231521e+01,   // 958
                                           -6.701872039004849e+01,   // 959
                                           6.125154258483237e+01,    // 960
                                           -2.497473921670156e+01,   // 961
                                           1.830792232769040e+02,    // 962
                                           6.842979769311105e+00,    // 963
                                           5.224753046084866e+01,    // 964
                                           3.315053382596193e+02,    // 965
                                           -4.066220323871705e+01,   // 966
                                           -1.568920876388370e+02,   // 967
                                           8.870743485805224e+01,    // 968
                                           -8.177241863165963e+01,   // 969
                                           -1.636462528586869e+02,   // 970
                                           -3.249209671154479e+01,   // 971
                                           2.473676865968607e+01,    // 972
                                           6.973897452482095e+01,    // 973
                                           -1.864371967085400e+01,   // 974
                                           -2.456910448425882e+02,   // 975
                                           6.258730821340641e+01,    // 976
                                           2.826168365048005e+02,    // 977
                                           -2.480127615193289e+02,   // 978
                                           -1.026983775835487e+02,   // 979
                                           2.250896968281539e+01,    // 980
                                           -5.790251351990559e+01,   // 981
                                           -4.740644784788387e+01};  // 982

        m_k_AD = 7.286306346099436e-01;        // A^(-1))
        m_k_AE = 7.828602981218888e-01;        // A^(-1))
        m_k_BD = 3.351348473713356e-01;        // A^(-1))
        m_k_BE = 3.639320594943890e-01;        // A^(-1))
        m_k_CD = 6.858079184494418e-01;        // A^(-1))
        m_k_CE = 6.808310453124187e-01;        // A^(-1))
        m_k_intra_BB = 6.196445062175264e-01;  // A^(-1))
        m_k_intra_CC = 3.302260758676124e-01;  // A^(-1))
        m_k_intra_AB = 8.129813213030901e-01;  // A^(-1))
        m_k_intra_AC = 4.872207055177465e-01;  // A^(-1))
        m_k_intra_BC = 9.817144022006012e-01;  // A^(-1))
        m_k_intra_EE = 1.532053819248005e-01;  // A^(-1))
        m_k_intra_DE = 1.268361659534204e+00;  // A^(-1))
        m_r2i = 8.000000000000000e+00;         // A
        m_r2f = 9.000000000000000e+00;         // A

    }  // if mon1 == "h2o" && mon2  == "n2o5"
}

//----------------------------------------------------------------------------//

double x2b_A1B2C4_D1E2_v1x::f_switch(const double& r, double& g) const {
    if (r > m_r2f) {
        g = 0.0;
        return 0.0;
    } else if (r > m_r2i) {
        const double t1 = M_PI / (m_r2f - m_r2i);
        const double x = (r - m_r2i) * t1;
        g = -std::sin(x) * t1 / 2.0;
        return (1.0 + std::cos(x)) / 2.0;
    } else {
        g = 0.0;
        return 1.0;
    }
}

//----------------------------------------------------------------------------//

double x2b_A1B2C4_D1E2_v1x::eval(const double* xyz1, const double* xyz2, const size_t ndim) const {
    std::vector<double> energies(ndim, 0.0);

    for (size_t j = 0; j < ndim; j++) {
        double mon1[21];
        double mon2[9];

        std::copy(xyz1 + j * 21, xyz1 + (j + 1) * 21, mon1);
        std::copy(xyz2 + j * 9, xyz2 + (j + 1) * 9, mon2);

        // Right now it assumes 1st atom of each monomer
        const double d12[3] = {mon1[0] - mon2[0], mon1[1] - mon2[1], mon1[2] - mon2[2]};

        const double r12sq = d12[0] * d12[0] + d12[1] * d12[1] + d12[2] * d12[2];
        const double r12 = std::sqrt(r12sq);

        if (r12 > m_r2f) continue;

        double xcrd[30];  // coordinates of real sites ONLY

        std::copy(mon1, mon1 + 21, xcrd);
        std::copy(mon2, mon2 + 9, xcrd + 21);

        double v[45];

        double sw = 0.0;
        double gsw = 0.0;

        const double* A_1_a = xcrd + 0;
        const double* B_1_a = xcrd + 3;
        const double* B_2_a = xcrd + 6;
        const double* C_1_a = xcrd + 9;
        const double* C_2_a = xcrd + 12;
        const double* C_3_a = xcrd + 15;
        const double* C_4_a = xcrd + 18;

        const double* D_1_b = xcrd + 21;
        const double* E_1_b = xcrd + 24;
        const double* E_2_b = xcrd + 27;

        variable vr[45];

        v[0] = vr[0].v_exp(m_k_intra_BB, B_1_a, B_2_a);
        v[1] = vr[1].v_exp(m_k_intra_CC, C_1_a, C_2_a);
        v[2] = vr[2].v_exp(m_k_intra_CC, C_1_a, C_3_a);
        v[3] = vr[3].v_exp(m_k_intra_CC, C_1_a, C_4_a);
        v[4] = vr[4].v_exp(m_k_intra_CC, C_2_a, C_3_a);
        v[5] = vr[5].v_exp(m_k_intra_CC, C_2_a, C_4_a);
        v[6] = vr[6].v_exp(m_k_intra_CC, C_3_a, C_4_a);
        v[7] = vr[7].v_exp(m_k_intra_AB, A_1_a, B_1_a);
        v[8] = vr[8].v_exp(m_k_intra_AB, A_1_a, B_2_a);
        v[9] = vr[9].v_exp(m_k_intra_AC, A_1_a, C_1_a);
        v[10] = vr[10].v_exp(m_k_intra_AC, A_1_a, C_2_a);
        v[11] = vr[11].v_exp(m_k_intra_AC, A_1_a, C_3_a);
        v[12] = vr[12].v_exp(m_k_intra_AC, A_1_a, C_4_a);
        v[13] = vr[13].v_exp(m_k_intra_BC, B_1_a, C_1_a);
        v[14] = vr[14].v_exp(m_k_intra_BC, B_1_a, C_2_a);
        v[15] = vr[15].v_exp(m_k_intra_BC, B_1_a, C_3_a);
        v[16] = vr[16].v_exp(m_k_intra_BC, B_1_a, C_4_a);
        v[17] = vr[17].v_exp(m_k_intra_BC, B_2_a, C_1_a);
        v[18] = vr[18].v_exp(m_k_intra_BC, B_2_a, C_2_a);
        v[19] = vr[19].v_exp(m_k_intra_BC, B_2_a, C_3_a);
        v[20] = vr[20].v_exp(m_k_intra_BC, B_2_a, C_4_a);
        v[21] = vr[21].v_exp(m_k_intra_EE, E_1_b, E_2_b);
        v[22] = vr[22].v_exp(m_k_intra_DE, D_1_b, E_1_b);
        v[23] = vr[23].v_exp(m_k_intra_DE, D_1_b, E_2_b);
        v[24] = vr[24].v_exp(m_k_AD, A_1_a, D_1_b);
        v[25] = vr[25].v_exp(m_k_AE, A_1_a, E_1_b);
        v[26] = vr[26].v_exp(m_k_AE, A_1_a, E_2_b);
        v[27] = vr[27].v_exp(m_k_BD, B_1_a, D_1_b);
        v[28] = vr[28].v_exp(m_k_BD, B_2_a, D_1_b);
        v[29] = vr[29].v_exp(m_k_BE, B_1_a, E_1_b);
        v[30] = vr[30].v_exp(m_k_BE, B_1_a, E_2_b);
        v[31] = vr[31].v_exp(m_k_BE, B_2_a, E_1_b);
        v[32] = vr[32].v_exp(m_k_BE, B_2_a, E_2_b);
        v[33] = vr[33].v_exp(m_k_CD, C_1_a, D_1_b);
        v[34] = vr[34].v_exp(m_k_CD, C_2_a, D_1_b);
        v[35] = vr[35].v_exp(m_k_CD, C_3_a, D_1_b);
        v[36] = vr[36].v_exp(m_k_CD, C_4_a, D_1_b);
        v[37] = vr[37].v_exp(m_k_CE, C_1_a, E_1_b);
        v[38] = vr[38].v_exp(m_k_CE, C_1_a, E_2_b);
        v[39] = vr[39].v_exp(m_k_CE, C_2_a, E_1_b);
        v[40] = vr[40].v_exp(m_k_CE, C_2_a, E_2_b);
        v[41] = vr[41].v_exp(m_k_CE, C_3_a, E_1_b);
        v[42] = vr[42].v_exp(m_k_CE, C_3_a, E_2_b);
        v[43] = vr[43].v_exp(m_k_CE, C_4_a, E_1_b);
        v[44] = vr[44].v_exp(m_k_CE, C_4_a, E_2_b);

        sw = f_switch(r12, gsw);

        energies[j] = sw * polynomial::eval(coefficients.data(), v);
    }

    double energy = 0.0;
    for (size_t i = 0; i < ndim; i++) {
        energy += energies[i];
    }

    return energy;
}

double x2b_A1B2C4_D1E2_v1x::eval(const double* xyz1, const double* xyz2, double* grad1, double* grad2,
                                 const size_t ndim, std::vector<double>* virial) const {
    std::vector<double> energies(ndim, 0.0);

    for (size_t j = 0; j < ndim; j++) {
        double mon1[21];
        double mon2[9];

        std::copy(xyz1 + j * 21, xyz1 + (j + 1) * 21, mon1);
        std::copy(xyz2 + j * 9, xyz2 + (j + 1) * 9, mon2);

        // Right now it assumes 1st atom of each monomer
        const double d12[3] = {mon1[0] - mon2[0], mon1[1] - mon2[1], mon1[2] - mon2[2]};

        const double r12sq = d12[0] * d12[0] + d12[1] * d12[1] + d12[2] * d12[2];
        const double r12 = std::sqrt(r12sq);

        if (r12 > m_r2f) continue;

        double xcrd[30];  // coordinates of real sites ONLY

        std::copy(mon1, mon1 + 21, xcrd);
        std::copy(mon2, mon2 + 9, xcrd + 21);

        double v[45];

        double sw = 0.0;
        double gsw = 0.0;

        const double* A_1_a = xcrd + 0;
        const double* B_1_a = xcrd + 3;
        const double* B_2_a = xcrd + 6;
        const double* C_1_a = xcrd + 9;
        const double* C_2_a = xcrd + 12;
        const double* C_3_a = xcrd + 15;
        const double* C_4_a = xcrd + 18;

        const double* D_1_b = xcrd + 21;
        const double* E_1_b = xcrd + 24;
        const double* E_2_b = xcrd + 27;

        variable vr[45];

        v[0] = vr[0].v_exp(m_k_intra_BB, B_1_a, B_2_a);
        v[1] = vr[1].v_exp(m_k_intra_CC, C_1_a, C_2_a);
        v[2] = vr[2].v_exp(m_k_intra_CC, C_1_a, C_3_a);
        v[3] = vr[3].v_exp(m_k_intra_CC, C_1_a, C_4_a);
        v[4] = vr[4].v_exp(m_k_intra_CC, C_2_a, C_3_a);
        v[5] = vr[5].v_exp(m_k_intra_CC, C_2_a, C_4_a);
        v[6] = vr[6].v_exp(m_k_intra_CC, C_3_a, C_4_a);
        v[7] = vr[7].v_exp(m_k_intra_AB, A_1_a, B_1_a);
        v[8] = vr[8].v_exp(m_k_intra_AB, A_1_a, B_2_a);
        v[9] = vr[9].v_exp(m_k_intra_AC, A_1_a, C_1_a);
        v[10] = vr[10].v_exp(m_k_intra_AC, A_1_a, C_2_a);
        v[11] = vr[11].v_exp(m_k_intra_AC, A_1_a, C_3_a);
        v[12] = vr[12].v_exp(m_k_intra_AC, A_1_a, C_4_a);
        v[13] = vr[13].v_exp(m_k_intra_BC, B_1_a, C_1_a);
        v[14] = vr[14].v_exp(m_k_intra_BC, B_1_a, C_2_a);
        v[15] = vr[15].v_exp(m_k_intra_BC, B_1_a, C_3_a);
        v[16] = vr[16].v_exp(m_k_intra_BC, B_1_a, C_4_a);
        v[17] = vr[17].v_exp(m_k_intra_BC, B_2_a, C_1_a);
        v[18] = vr[18].v_exp(m_k_intra_BC, B_2_a, C_2_a);
        v[19] = vr[19].v_exp(m_k_intra_BC, B_2_a, C_3_a);
        v[20] = vr[20].v_exp(m_k_intra_BC, B_2_a, C_4_a);
        v[21] = vr[21].v_exp(m_k_intra_EE, E_1_b, E_2_b);
        v[22] = vr[22].v_exp(m_k_intra_DE, D_1_b, E_1_b);
        v[23] = vr[23].v_exp(m_k_intra_DE, D_1_b, E_2_b);
        v[24] = vr[24].v_exp(m_k_AD, A_1_a, D_1_b);
        v[25] = vr[25].v_exp(m_k_AE, A_1_a, E_1_b);
        v[26] = vr[26].v_exp(m_k_AE, A_1_a, E_2_b);
        v[27] = vr[27].v_exp(m_k_BD, B_1_a, D_1_b);
        v[28] = vr[28].v_exp(m_k_BD, B_2_a, D_1_b);
        v[29] = vr[29].v_exp(m_k_BE, B_1_a, E_1_b);
        v[30] = vr[30].v_exp(m_k_BE, B_1_a, E_2_b);
        v[31] = vr[31].v_exp(m_k_BE, B_2_a, E_1_b);
        v[32] = vr[32].v_exp(m_k_BE, B_2_a, E_2_b);
        v[33] = vr[33].v_exp(m_k_CD, C_1_a, D_1_b);
        v[34] = vr[34].v_exp(m_k_CD, C_2_a, D_1_b);
        v[35] = vr[35].v_exp(m_k_CD, C_3_a, D_1_b);
        v[36] = vr[36].v_exp(m_k_CD, C_4_a, D_1_b);
        v[37] = vr[37].v_exp(m_k_CE, C_1_a, E_1_b);
        v[38] = vr[38].v_exp(m_k_CE, C_1_a, E_2_b);
        v[39] = vr[39].v_exp(m_k_CE, C_2_a, E_1_b);
        v[40] = vr[40].v_exp(m_k_CE, C_2_a, E_2_b);
        v[41] = vr[41].v_exp(m_k_CE, C_3_a, E_1_b);
        v[42] = vr[42].v_exp(m_k_CE, C_3_a, E_2_b);
        v[43] = vr[43].v_exp(m_k_CE, C_4_a, E_1_b);
        v[44] = vr[44].v_exp(m_k_CE, C_4_a, E_2_b);

        double g[45];

        // the switch
        sw = f_switch(r12, gsw);

        energies[j] = polynomial::eval(coefficients.data(), v, g);

        double xgrd[30];
        std::fill(xgrd, xgrd + 30, 0.0);

        double* A_1_a_g = xgrd + 0;
        double* B_1_a_g = xgrd + 3;
        double* B_2_a_g = xgrd + 6;
        double* C_1_a_g = xgrd + 9;
        double* C_2_a_g = xgrd + 12;
        double* C_3_a_g = xgrd + 15;
        double* C_4_a_g = xgrd + 18;

        double* D_1_b_g = xgrd + 21;
        double* E_1_b_g = xgrd + 24;
        double* E_2_b_g = xgrd + 27;

        vr[0].grads(g[0], B_1_a_g, B_2_a_g, B_1_a, B_2_a);
        vr[1].grads(g[1], C_1_a_g, C_2_a_g, C_1_a, C_2_a);
        vr[2].grads(g[2], C_1_a_g, C_3_a_g, C_1_a, C_3_a);
        vr[3].grads(g[3], C_1_a_g, C_4_a_g, C_1_a, C_4_a);
        vr[4].grads(g[4], C_2_a_g, C_3_a_g, C_2_a, C_3_a);
        vr[5].grads(g[5], C_2_a_g, C_4_a_g, C_2_a, C_4_a);
        vr[6].grads(g[6], C_3_a_g, C_4_a_g, C_3_a, C_4_a);
        vr[7].grads(g[7], A_1_a_g, B_1_a_g, A_1_a, B_1_a);
        vr[8].grads(g[8], A_1_a_g, B_2_a_g, A_1_a, B_2_a);
        vr[9].grads(g[9], A_1_a_g, C_1_a_g, A_1_a, C_1_a);
        vr[10].grads(g[10], A_1_a_g, C_2_a_g, A_1_a, C_2_a);
        vr[11].grads(g[11], A_1_a_g, C_3_a_g, A_1_a, C_3_a);
        vr[12].grads(g[12], A_1_a_g, C_4_a_g, A_1_a, C_4_a);
        vr[13].grads(g[13], B_1_a_g, C_1_a_g, B_1_a, C_1_a);
        vr[14].grads(g[14], B_1_a_g, C_2_a_g, B_1_a, C_2_a);
        vr[15].grads(g[15], B_1_a_g, C_3_a_g, B_1_a, C_3_a);
        vr[16].grads(g[16], B_1_a_g, C_4_a_g, B_1_a, C_4_a);
        vr[17].grads(g[17], B_2_a_g, C_1_a_g, B_2_a, C_1_a);
        vr[18].grads(g[18], B_2_a_g, C_2_a_g, B_2_a, C_2_a);
        vr[19].grads(g[19], B_2_a_g, C_3_a_g, B_2_a, C_3_a);
        vr[20].grads(g[20], B_2_a_g, C_4_a_g, B_2_a, C_4_a);
        vr[21].grads(g[21], E_1_b_g, E_2_b_g, E_1_b, E_2_b);
        vr[22].grads(g[22], D_1_b_g, E_1_b_g, D_1_b, E_1_b);
        vr[23].grads(g[23], D_1_b_g, E_2_b_g, D_1_b, E_2_b);
        vr[24].grads(g[24], A_1_a_g, D_1_b_g, A_1_a, D_1_b);
        vr[25].grads(g[25], A_1_a_g, E_1_b_g, A_1_a, E_1_b);
        vr[26].grads(g[26], A_1_a_g, E_2_b_g, A_1_a, E_2_b);
        vr[27].grads(g[27], B_1_a_g, D_1_b_g, B_1_a, D_1_b);
        vr[28].grads(g[28], B_2_a_g, D_1_b_g, B_2_a, D_1_b);
        vr[29].grads(g[29], B_1_a_g, E_1_b_g, B_1_a, E_1_b);
        vr[30].grads(g[30], B_1_a_g, E_2_b_g, B_1_a, E_2_b);
        vr[31].grads(g[31], B_2_a_g, E_1_b_g, B_2_a, E_1_b);
        vr[32].grads(g[32], B_2_a_g, E_2_b_g, B_2_a, E_2_b);
        vr[33].grads(g[33], C_1_a_g, D_1_b_g, C_1_a, D_1_b);
        vr[34].grads(g[34], C_2_a_g, D_1_b_g, C_2_a, D_1_b);
        vr[35].grads(g[35], C_3_a_g, D_1_b_g, C_3_a, D_1_b);
        vr[36].grads(g[36], C_4_a_g, D_1_b_g, C_4_a, D_1_b);
        vr[37].grads(g[37], C_1_a_g, E_1_b_g, C_1_a, E_1_b);
        vr[38].grads(g[38], C_1_a_g, E_2_b_g, C_1_a, E_2_b);
        vr[39].grads(g[39], C_2_a_g, E_1_b_g, C_2_a, E_1_b);
        vr[40].grads(g[40], C_2_a_g, E_2_b_g, C_2_a, E_2_b);
        vr[41].grads(g[41], C_3_a_g, E_1_b_g, C_3_a, E_1_b);
        vr[42].grads(g[42], C_3_a_g, E_2_b_g, C_3_a, E_2_b);
        vr[43].grads(g[43], C_4_a_g, E_1_b_g, C_4_a, E_1_b);
        vr[44].grads(g[44], C_4_a_g, E_2_b_g, C_4_a, E_2_b);

        // ##DEFINE HERE## the redistribution of the gradients

        for (int i = 0; i < 21; ++i) {
            grad1[i + j * 21] += sw * xgrd[i];
        }

        for (int i = 0; i < 9; ++i) {
            grad2[i + j * 9] += sw * xgrd[i + 21];
        }

        // gradient of the switch

        gsw *= energies[j] / r12;
        for (int i = 0; i < 3; ++i) {
            const double d = gsw * d12[i];
            grad1[i + j * 21] += d;
            grad2[i + j * 9] -= d;
        }
        energies[j] *= sw;

        if (virial != 0) {
            (*virial)[0] += -A_1_a[0] * A_1_a_g[0] - B_1_a[0] * B_1_a_g[0] - B_2_a[0] * B_2_a_g[0] -
                            C_1_a[0] * C_1_a_g[0] - C_2_a[0] * C_2_a_g[0] - C_3_a[0] * C_3_a_g[0] -
                            C_4_a[0] * C_4_a_g[0] - D_1_b[0] * D_1_b_g[0] - E_1_b[0] * E_1_b_g[0] -
                            E_2_b[0] * E_2_b_g[0];

            (*virial)[1] += -A_1_a[0] * A_1_a_g[1] - B_1_a[0] * B_1_a_g[1] - B_2_a[0] * B_2_a_g[1] -
                            C_1_a[0] * C_1_a_g[1] - C_2_a[0] * C_2_a_g[1] - C_3_a[0] * C_3_a_g[1] -
                            C_4_a[0] * C_4_a_g[1] - D_1_b[0] * D_1_b_g[1] - E_1_b[0] * E_1_b_g[1] -
                            E_2_b[0] * E_2_b_g[1];

            (*virial)[2] += -A_1_a[0] * A_1_a_g[2] - B_1_a[0] * B_1_a_g[2] - B_2_a[0] * B_2_a_g[2] -
                            C_1_a[0] * C_1_a_g[2] - C_2_a[0] * C_2_a_g[2] - C_3_a[0] * C_3_a_g[2] -
                            C_4_a[0] * C_4_a_g[2] - D_1_b[0] * D_1_b_g[2] - E_1_b[0] * E_1_b_g[2] -
                            E_2_b[0] * E_2_b_g[2];

            (*virial)[4] += -A_1_a[1] * A_1_a_g[1] - B_1_a[1] * B_1_a_g[1] - B_2_a[1] * B_2_a_g[1] -
                            C_1_a[1] * C_1_a_g[1] - C_2_a[1] * C_2_a_g[1] - C_3_a[1] * C_3_a_g[1] -
                            C_4_a[1] * C_4_a_g[1] - D_1_b[1] * D_1_b_g[1] - E_1_b[1] * E_1_b_g[1] -
                            E_2_b[1] * E_2_b_g[1];

            (*virial)[5] += -A_1_a[1] * A_1_a_g[2] - B_1_a[1] * B_1_a_g[2] - B_2_a[1] * B_2_a_g[2] -
                            C_1_a[1] * C_1_a_g[2] - C_2_a[1] * C_2_a_g[2] - C_3_a[1] * C_3_a_g[2] -
                            C_4_a[1] * C_4_a_g[2] - D_1_b[1] * D_1_b_g[2] - E_1_b[1] * E_1_b_g[2] -
                            E_2_b[1] * E_2_b_g[2];

            (*virial)[8] += -A_1_a[2] * A_1_a_g[2] - B_1_a[2] * B_1_a_g[2] - B_2_a[2] * B_2_a_g[2] -
                            C_1_a[2] * C_1_a_g[2] - C_2_a[2] * C_2_a_g[2] - C_3_a[2] * C_3_a_g[2] -
                            C_4_a[2] * C_4_a_g[2] - D_1_b[2] * D_1_b_g[2] - E_1_b[2] * E_1_b_g[2] -
                            E_2_b[2] * E_2_b_g[2];

            (*virial)[3] = (*virial)[1];
            (*virial)[6] = (*virial)[2];
            (*virial)[7] = (*virial)[5];
        }
    }

    double energy = 0.0;
    for (size_t i = 0; i < ndim; i++) {
        energy += energies[i];
    }

    return energy;
}

}  // namespace x2b_A1B2C4_D1E2_deg3

////////////////////////////////////////////////////////////////////////////////
